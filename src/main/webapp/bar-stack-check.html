<!DOCTYPE html>
<html style="height: 100%">
   <head>
       <meta charset="utf-8">
   </head>
   <body style="height: 100%; margin: 0">
       <div id="container" style="height: 100%"></div>
       <script type="text/javascript" src="gallery/vendors/echarts/echarts.min.js"></script>
       <script type="text/javascript" src="gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
       <script type="text/javascript" src="gallery/vendors/echarts-stat/ecStat.min.js"></script>
       <script type="text/javascript" src="gallery/vendors/echarts/extension/dataTool.min.js"></script>
       <script type="text/javascript" src="gallery/vendors/echarts/map/js/china.js"></script>
       <script type="text/javascript" src="gallery/vendors/echarts/map/js/world.js"></script>
       <script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
       <script type="text/javascript" src="gallery/vendors/echarts/extension/bmap.min.js"></script>
       <script type="text/javascript" src="gallery/vendors/simplex.js"></script>
       <script type="text/javascript">
           $(function(){
               $.ajax({
                   //提交数据的类型 POST GET
                   type:"POST",
                   //提交的网址
                   //url:"http://localhost:8080/lightmanger/filemanager/fileDownload/fileDownloadPie",
                   url:"<%=request.getContextPath()%>/filemanager/fileDownload/fileDownloadPie",
                   //提交的数据
                   data:{},
                   //返回数据的格式
                   datatype: "html",//"xml", "html", "script", "json", "jsonp", "text".
                   //在请求之前调用的函数
                   beforeSend:function(){$("#msg").html("lodding");},
                   //成功返回之后调用的函数
                   success:function(result){
                       result = $.parseJSON(result);
                       var keys=[];    //类别数组（实际用来盛放X轴坐标值）
                       var values=[];    //销量数组（实际用来盛放Y坐标值
                       var keysArray= new Array();
                       keysArray=result.key.split("#"); //字符分割
                       for (var i=0;i<keysArray.length ;i++ ) {
                           keys.push(keysArray[i]);
                       }
                       var valuesArray= new Array();
                       valuesArray=result.value.split("#"); //字符分割
                       for (var i=0;i<valuesArray.length ;i++ ) {
                           values.push(eval('(' + valuesArray[i] + ')'));
                       }
                       var myChart = echarts.init(document.getElementById('mainPie'));
                       option = {
                           title : {
                               text: '自升级用户访下载量',
                               subtext: 'apk下载量',
                               x:'center'
                           },
                           tooltip : {
                               trigger: 'item',
                               formatter: "{a} <br/>{b} : {c} ({d}%)"
                           },
                           legend: {
                               orient: 'vertical',
                               left: 'left',
                               //data:['直接访问','邮件营销','联盟广告','视频广告','搜索引擎']
                               data:keys
                           },
                           series : [
                               {
                                   name: '下载次数',
                                   type: 'pie',
                                   radius : '55%',
                                   center: ['50%', '60%'],
                                   data:values,
                                   /*  [
                                     {value:335, name:'直接访问'},
                                   {value:310, name:'邮件营销'},
                                   {value:234, name:'联盟广告'},
                                        {value:135, name:'视频广告'},
                                   {value:1548, name:'搜索引擎'}		     		                  ], */
                                   itemStyle: {
                                       emphasis: {
                                           shadowBlur: 10,
                                           shadowOffsetX: 0,
                                           shadowColor: 'rgba(0, 0, 0, 0.5)'
                                       }
                                   }
                               }
                           ]
                       };
                       myChart.setOption(option);
                   }   ,
                   //调用执行后调用的函数
                   complete: function(XMLHttpRequest, textStatus){
                       //alert(XMLHttpRequest.responseText);
                       //alert(textStatus);
                   },
                   //调用出错执行的函数
                   error: function(){
                       //请求出错处理
                   }
               });
           });



/*var dom = document.getElementById("container");
var myChart = echarts.init(dom);
var app = {};
option = null;
app.title = '堆叠柱状图';

option = {
    tooltip : {
        trigger: 'axis',
        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
    },
    legend: {
        data:['直接访问','邮件营销','联盟广告','视频广告','搜索引擎','百度','谷歌','必应','其他']
    },
    grid: {
        left: '10%',
        right: '15%',
        bottom: '3%',
        containLabel: true
    },
    xAxis : [
        {
            type : 'category',
            data : ['周一','周二','周三','周四','周五','周六','周日']
        }
    ],
    yAxis : [
        {
            type : 'value'
        }
    ],
    series : [
        /!*{
            name:'直接访问',
            type:'bar',
            data:[320, 332, 301, 334, 390, 330, 320]
        },*!/
        {
            name:'邮件营销',
            type:'bar',
            stack: '广告',
            barWidth : 30,//柱图宽度
            data:[120, 132, 101, 134, 90, 230, 210]
        },
        {
            name:'联盟广告',
            type:'bar',
            stack: '广告',
            data:[220, 182, 191, 234, 290, 330, 310]
        },
        {
            name:'视频广告',
            type:'bar',
            stack: '广告',
            data:[150, 232, 201, 154, 190, 330, 410]
        },
        /!*{
            name:'搜索引擎',
            type:'bar',
            data:[862, 1018, 964, 1026, 1679, 1600, 1570],
            markLine : {
                lineStyle: {
                    normal: {
                        type: 'dashed'
                    }
                },
                data : [
                    [{type : 'min'}, {type : 'max'}]
                ]
            }
        },
        {
            name:'百度',
            type:'bar',
            barWidth : 5,
            stack: '搜索引擎',
            data:[620, 732, 701, 734, 1090, 1130, 1120]
        },
        {
            name:'谷歌',
            type:'bar',
            stack: '搜索引擎',
            data:[120, 132, 101, 134, 290, 230, 220]
        },
        {
            name:'必应',
            type:'bar',
            stack: '搜索引擎',
            data:[60, 72, 71, 74, 190, 130, 110]
        },
        {
            name:'其他',
            type:'bar',
            stack: '搜索引擎',
            data:[62, 82, 91, 84, 109, 110, 120]
        }*!/
    ]
};
;
if (option && typeof option === "object") {
    myChart.setOption(option, true);
}*/
       </script>
   </body>
</html>